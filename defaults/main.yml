---

etcd_data_dir: '/data/etcd'
etcd_docker_image: "quay.io/coreos/etcd"
etcd_docker_ports:
  - "{{etcd_client_port}}:{{etcd_client_port}}"
  - "{{etcd_peer_port}}:{{etcd_peer_port}}"
etcd_docker_tag: 'latest'
etcd_docker_volumes: ["{{etcd_data_dir}}:{{etcd_data_dir}}"]
etcd_url_scheme: http
etcd_interface: eth0

# Client Settings
etcd_client_port: 2379
etcd_client_interface: "{{ etcd_interface }}"
etcd_client_url_scheme: "{{ etcd_url_scheme }}"

# Cluster peer settings
etcd_peer_port: 2380
etcd_peer_interface: "{{ etcd_interface }}"
etcd_peer_url_scheme: "{{ etcd_url_scheme }}"
etcd_peers_group: 'etcd_peers'

etcd_client_ipaddress: "{{ hostvars[inventory_hostname]['ansible_' + etcd_peer_interface]['ipv4']['address'] }}"
etcd_name: "{{ etcd_client_ipaddress }}"

# Ports to bind to
etcd_listen_client_urls: "{{ etcd_client_url_scheme }}://0.0.0.0:{{ etcd_client_port }}"
etcd_listen_peer_urls: "{{ etcd_peer_url_scheme }}://0.0.0.0:{{ etcd_peer_port }}"

# Advertise settings
etcd_advertise_client_urls: "{{ etcd_client_url_scheme }}://{{ hostvars[inventory_hostname]['ansible_' + etcd_client_interface]['ipv4']['address'] }}:{{ etcd_client_port }}"
etcd_initial_advertise_peer_urls: "{{ etcd_peer_url_scheme }}://{{ hostvars[inventory_hostname]['ansible_' + etcd_peer_interface]['ipv4']['address'] }}:{{ etcd_peer_port }}"

# Cluster settings
etcd_initial_cluster_token: etcd-cluster
etcd_initial_cluster_state: "new"
etcd_initial_cluster: "
  {%- if etcd_peers is defined -%}
      {% for host in etcd_peers %}{{ host }}={{ etcd_peer_url_scheme }}://{{ host }}:{{ etcd_peer_port }}{% if not loop.last %},{% endif %}{% endfor %}
  {%- else -%}
      {% for host in groups[etcd_peers_group] -%}{{ host }}={{ etcd_peer_url_scheme }}://{{ hostvars[host]['ansible_' + etcd_peer_interface]['ipv4']['address'] }}:{{ etcd_peer_port }}{% if not loop.last %},{% endif %}{% endfor %}
	{%- endif -%}
"
